<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Winnerå°åŠ©æ‰‹ v5.0 - ä¹å¤§å½©åˆ¸å°çä¸­å¿ƒ</title>
    <style>
        body { font-family: 'PingFang TC', sans-serif; background: #f4f4f9; margin: 0; padding: 0; }
        header { background: #b71c1c; color: white; padding: 15px; text-align: center; font-size: 22px; font-weight: bold; }
        
        /* ä¹ç¨®å½©åˆ¸é¸å–® - æ”¯æ´æ»‘å‹• */
        .nav-tabs { display: flex; overflow-x: auto; background: white; padding: 12px; gap: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .tab-btn { white-space: nowrap; padding: 8px 18px; border: 1px solid #ddd; background: #fff; border-radius: 20px; cursor: pointer; font-weight: bold; font-size: 14px; }
        .tab-btn.active { background: #d32f2f; color: white; border-color: #d32f2f; }

        .container { max-width: 800px; margin: 15px auto; padding: 0 10px; }
        .card { background: white; border-radius: 12px; padding: 20px; margin-bottom: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.08); }
        
        /* è³“æœå°ˆå±¬é¢æ¿ */
        .bingo-panel { background: #fff3e0; border-radius: 10px; padding: 15px; margin-bottom: 15px; display: none; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; }
        .bingo-panel select { width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ffb74d; }
        .bingo-panel label { font-size: 12px; color: #e65100; font-weight: bold; display: block; margin-bottom: 4px; }

        .check-area { display: flex; flex-direction: column; gap: 10px; }
        .main-input { padding: 15px; font-size: 20px; border: 2px solid #ddd; border-radius: 8px; text-align: center; font-weight: bold; }
        .btn-check { padding: 15px; background: #2e7d32; color: white; border: none; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; }

        /* å½©çƒæ¨£å¼ */
        .ball-row { display: flex; gap: 6px; flex-wrap: wrap; margin-top: 10px; }
        .ball { width: 34px; height: 34px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 15px; font-weight: bold; background: radial-gradient(circle at 10px 10px, #fffde7, #ffd54f); box-shadow: 1px 2px 3px rgba(0,0,0,0.2); color: #333; }
        .ball.sp { background: radial-gradient(circle at 10px 10px, #ffebee, #f44336); color: white; }
        
        /* è³“æœå¤§å°å–®é›™æ¨™ç±¤ */
        .badge { padding: 2px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; margin-right: 5px; color: white; }
        .bg-blue { background: #1976d2; }
        .bg-gray { background: #546e7a; }

        #result-display { margin-top: 15px; padding: 15px; border-radius: 10px; text-align: center; display: none; font-size: 18px; border: 2px solid #ccc; }
        .win { background: #e8f5e9; border-color: #4caf50; color: #1b5e20; }
    </style>
</head>
<body>

<header>ğŸ† Winnerå°åŠ©æ‰‹ v5.0</header>

<div class="nav-tabs" id="tabs">
    <button class="tab-btn active" onclick="switchGame('è³“æœè³“æœ')">è³“æœè³“æœ</button>
    <button class="tab-btn" onclick="switchGame('å¤§æ¨‚é€')">å¤§æ¨‚é€</button>
    <button class="tab-btn" onclick="switchGame('å¨åŠ›å½©')">å¨åŠ›å½©</button>
    <button class="tab-btn" onclick="switchGame('ä»Šå½©539')">ä»Šå½©539</button>
    <button class="tab-btn" onclick="switchGame('3æ˜Ÿå½©')">3æ˜Ÿå½©</button>
    <button class="tab-btn" onclick="switchGame('4æ˜Ÿå½©')">4æ˜Ÿå½©</button>
    <button class="tab-btn" onclick="switchGame('39æ¨‚åˆå½©')">39æ¨‚åˆå½©</button>
    <button class="tab-btn" onclick="switchGame('49æ¨‚åˆå½©')">49æ¨‚åˆå½©</button>
    <button class="tab-btn" onclick="switchGame('å¤§æ¨‚é€åŠ é–‹')">å¤§æ¨‚é€åŠ é–‹</button>
</div>

<div class="container">
    <div class="card">
        <h3 id="game-title" style="margin-top:0">è³“æœè³“æœå°ç</h3>
        
        <div id="bingo-extra" class="bingo-panel">
            <div>
                <label>ç©æ³•</label>
                <select id="bingo-type">
                    <option value="star">ä¸€èˆ¬ (1-10æ˜Ÿ)</option>
                    <option value="big-small">çŒœå¤§å°</option>
                    <option value="odd-even">çŒœå–®é›™</option>
                </select>
            </div>
            <div>
                <label>å¹¾æ˜Ÿç©æ³•</label>
                <select id="bingo-star"><option value="1">1æ˜Ÿ</option><option value="3">3æ˜Ÿ</option><option value="5">5æ˜Ÿ</option><option value="10">10æ˜Ÿ</option></select>
            </div>
            <div>
                <label>æŠ•æ³¨å€æ•¸</label>
                <select id="bingo-mult"><option value="1">1å€</option><option value="5">5å€</option><option value="10">10å€</option></select>
            </div>
            <div>
                <label>å°çæœŸæ•¸</label>
                <select id="period-select"></select>
            </div>
        </div>

        <div class="check-area">
            <input type="text" id="user-nums" class="main-input" placeholder="è¼¸å…¥è™Ÿç¢¼ (ç”¨ç©ºæ ¼åˆ†é–‹)">
            <button class="btn-check" onclick="checkAll()">é–‹å§‹å°çè¨ˆç®—çé‡‘</button>
        </div>
        
        <div id="result-display"></div>
    </div>

    <div class="card">
        <h4 style="margin-top:0">æœ€æ–°é–‹çæ­·å²</h4>
        <div id="history-container">è¼‰å…¥ä¸­...</div>
    </div>
</div>

<script>
// --- ä¹å¤§å½©åˆ¸è¨­å®šæª” ---
const LOTTO_MAP = {
    'è³“æœè³“æœ': { file: 'è³“æœè³“æœ_2026.csv', balls: 'é–‹å‡ºè™Ÿç¢¼', super: 'è¶…ç´šçè™Ÿ', tags: ['å¤§å°', 'å–®é›™'] },
    'å¤§æ¨‚é€': { file: 'å¤§æ¨‚é€_2026.csv', balls: ['çè™Ÿ1','çè™Ÿ2','çè™Ÿ3','çè™Ÿ4','çè™Ÿ5','çè™Ÿ6'], super: 'ç‰¹åˆ¥è™Ÿ' },
    'å¨åŠ›å½©': { file: 'å¨åŠ›å½©_2026.csv', balls: ['ç¬¬ä¸€å€1','ç¬¬ä¸€å€2','ç¬¬ä¸€å€3','ç¬¬ä¸€å€4','ç¬¬ä¸€å€5','ç¬¬ä¸€å€6'], super: 'ç¬¬äºŒå€' },
    'ä»Šå½©539': { file: 'ä»Šå½©539_2026.csv', balls: ['çè™Ÿ1','çè™Ÿ2','çè™Ÿ3','çè™Ÿ4','çè™Ÿ5'], super: null },
    '3æ˜Ÿå½©': { file: '3æ˜Ÿå½©_2026.csv', balls: ['çè™Ÿ1','çè™Ÿ2','çè™Ÿ3'], super: null },
    '4æ˜Ÿå½©': { file: '4æ˜Ÿå½©_2026.csv', balls: ['çè™Ÿ1','çè™Ÿ2','çè™Ÿ3','çè™Ÿ4'], super: null },
    '39æ¨‚åˆå½©': { file: '39æ¨‚åˆå½©_2026.csv', balls: ['çè™Ÿ1','çè™Ÿ2','çè™Ÿ3','çè™Ÿ4','çè™Ÿ5'], super: null },
    '49æ¨‚åˆå½©': { file: '49æ¨‚åˆå½©_2026.csv', balls: ['çè™Ÿ1','çè™Ÿ2','çè™Ÿ3','çè™Ÿ4','çè™Ÿ5','çè™Ÿ6'], super: null },
    'å¤§æ¨‚é€åŠ é–‹': { file: 'å¤§æ¨‚é€åŠ é–‹çé …_2026.csv', balls: ['çè™Ÿ1','çè™Ÿ2','çè™Ÿ3','çè™Ÿ4','çè™Ÿ5','çè™Ÿ6'], super: null }
};

let currentGame = 'è³“æœè³“æœ';
let gameData = [];

async function switchGame(name) {
    currentGame = name;
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.toggle('active', b.innerText === name));
    document.getElementById('game-title').innerText = name + 'å°ç';
    document.getElementById('bingo-extra').style.display = (name === 'è³“æœè³“æœ') ? 'grid' : 'none';
    await loadData();
}

async function loadData() {
    const container = document.getElementById('history-container');
    container.innerHTML = 'è®€å–ä¸­...';
    try {
        const res = await fetch(`./lotto/${LOTTO_MAP[currentGame].file}`);
        const text = await res.text();
        gameData = parseCSV(text);
        
        const periodSel = document.getElementById('period-select');
        periodSel.innerHTML = gameData.slice(0, 20).map(d => `<option value="${d.æœŸæ•¸ || d.æœŸåˆ¥}">${d.æœŸæ•¸ || d.æœŸåˆ¥}</option>`).join('');
        
        renderHistory();
    } catch (e) { container.innerHTML = 'æ‰¾ä¸åˆ°è³‡æ–™æª”æ¡ˆã€‚'; }
}

function parseCSV(text) {
    const lines = text.trim().split('\n');
    const headers = lines[0].split(',').map(h => h.trim());
    return lines.slice(1).map(l => {
        let vals = [], q = false, cell = '';
        for (let char of l) {
            if (char === '"') q = !q;
            else if (char === ',' && !q) { vals.push(cell.trim()); cell = ''; }
            else cell += char;
        }
        vals.push(cell.trim());
        let o = {}; headers.forEach((h, i) => o[h] = vals[i]);
        return o;
    });
}

function renderHistory() {
    const container = document.getElementById('history-container');
    container.innerHTML = '';
    gameData.slice(0, 10).forEach(row => {
        const item = document.createElement('div');
        item.style.padding = '12px 0'; item.style.borderBottom = '1px solid #eee';
        
        let ballList = [];
        if (currentGame === 'è³“æœè³“æœ') {
            ballList = row['é–‹å‡ºè™Ÿç¢¼'].split(/[ ,]+/).filter(n => n.length > 0);
        } else {
            LOTTO_MAP[currentGame].balls.forEach(k => ballList.push(row[k]));
        }

        let ballHtml = ballList.map(n => `<div class="ball">${n.padStart(2,'0')}</div>`).join('');
        if (LOTTO_MAP[currentGame].super && row[LOTTO_MAP[currentGame].super]) {
            ballHtml += `<div class="ball sp">${row[LOTTO_MAP[currentGame].super].padStart(2,'0')}</div>`;
        }

        let tags = '';
        if (currentGame === 'è³“æœè³“æœ') {
            tags = `<span class="badge bg-blue">å¤§å°: ${row['å¤§å°']||'ï¼'}</span><span class="badge bg-gray">å–®é›™: ${row['å–®é›™']||'ï¼'}</span>`;
        }

        item.innerHTML = `<div style="font-weight:bold; font-size:14px; margin-bottom:5px;">ç¬¬ ${row.æœŸæ•¸ || row.æœŸåˆ¥} æœŸ | ${row.æ—¥æœŸ || row.é–‹çæ—¥æœŸ} ${tags}</div><div class="ball-row">${ballHtml}</div>`;
        container.appendChild(item);
    });
}

function checkAll() {
    const targetP = document.getElementById('period-select').value;
    const draw = gameData.find(d => (d.æœŸæ•¸ || d.æœŸåˆ¥) === targetP);
    const resBox = document.getElementById('result-display');
    const input = document.getElementById('user-nums').value.trim();
    
    if (!draw) return;

    let winBalls = [];
    if (currentGame === 'è³“æœè³“æœ') {
        winBalls = draw['é–‹å‡ºè™Ÿç¢¼'].split(/[ ,]+/).map(n => n.trim().padStart(2,'0'));
        winBalls.push(draw['è¶…ç´šçè™Ÿ'].padStart(2,'0'));
    } else {
        LOTTO_MAP[currentGame].balls.forEach(k => winBalls.push(draw[k].padStart(2,'0')));
    }

    const userBalls = input.split(/[ ,]+/).map(n => n.padStart(2,'0'));
    const matched = userBalls.filter(n => winBalls.includes(n));
    
    resBox.style.display = 'block';
    resBox.className = matched.length > 0 ? 'win' : '';
    
    if (currentGame === 'è³“æœè³“æœ') {
        const type = document.getElementById('bingo-type').value;
        if (type === 'big-small') {
            const win = input.includes(draw['å¤§å°']);
            resBox.innerHTML = `æœ¬æœŸçµæœç‚ºï¼š<b>${draw['å¤§å°']}</b><br>${win ? 'ğŸŠ æ­å–œçŒœä¸­ï¼' : 'âŒ æ²’ä¸­'}`;
        } else if (type === 'odd-even') {
            const win = input.includes(draw['å–®é›™']);
            resBox.innerHTML = `æœ¬æœŸçµæœç‚ºï¼š<b>${draw['å–®é›™']}</b><br>${win ? 'ğŸŠ æ­å–œçŒœä¸­ï¼' : 'âŒ æ²’ä¸­'}`;
        } else {
            resBox.innerHTML = `ç¬¬ ${targetP} æœŸ å°ä¸­ <b>${matched.length}</b> é¡†ï¼<br>çé‡‘è¨ˆç®—ï¼šè«‹åƒè€ƒå°å½©å®˜ç¶²è³ ç‡è¡¨`;
        }
    } else {
        resBox.innerHTML = `ç¬¬ ${targetP} æœŸ å°ä¸­ <b>${matched.length}</b> é¡†è™Ÿç¢¼ï¼`;
    }
}
</script>
</body>
</html>
