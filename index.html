<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Winnerå°åŠ©æ‰‹ v6.0 - ä¹å¤§å½©åˆ¸å°çä¸­å¿ƒ</title>
    <style>
        :root { --primary: #d32f2f; --secondary: #ff9800; --bg: #f5f5f7; }
        body { font-family: 'PingFang TC', sans-serif; background: var(--bg); margin: 0; padding: 0; }
        header { background: var(--primary); color: white; padding: 15px; text-align: center; font-weight: bold; font-size: 22px; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
        
        /* ä¹ç¨®å½©åˆ¸å°è¦½ - æ”¯æ´æ©«å‘æ²å‹• */
        .nav-tabs { display: flex; overflow-x: auto; background: white; padding: 12px; gap: 8px; border-bottom: 1px solid #ddd; }
        .tab-btn { white-space: nowrap; padding: 8px 18px; border: 1px solid #ddd; background: #fff; border-radius: 25px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .tab-btn.active { background: var(--secondary); color: white; border-color: var(--secondary); }

        .container { max-width: 600px; margin: 15px auto; padding: 0 10px; }
        .card { background: white; border-radius: 12px; padding: 20px; margin-bottom: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        
        /* è³“æœæ§åˆ¶é¢æ¿ */
        .bingo-panel { background: #fff3e0; border-radius: 10px; padding: 15px; margin-bottom: 15px; display: none; grid-template-columns: 1fr 1fr; gap: 10px; }
        .option-group label { display: block; font-size: 12px; color: #e65100; font-weight: bold; margin-bottom: 4px; }
        .option-group select { width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ffb74d; }

        .check-area { display: flex; flex-direction: column; gap: 10px; }
        .main-input { padding: 15px; font-size: 20px; border: 2px solid #ddd; border-radius: 8px; text-align: center; font-weight: bold; }
        .btn-check { padding: 15px; background: #2e7d32; color: white; border: none; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; }

        /* å½©çƒè¦–è¦ºè¨­è¨ˆ */
        .ball-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 6px; margin-top: 10px; }
        .ball { height: 38px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 16px; font-weight: bold; background: radial-gradient(circle at 12px 12px, #fffde7, #ffd54f); box-shadow: 1px 2px 4px rgba(0,0,0,0.2); }
        .ball.sp { background: radial-gradient(circle at 12px 12px, #ffebee, #ef5350); color: white; border: 2px solid #b71c1c; }
        
        .badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; color: white; margin-right: 5px; }
        .bg-blue { background: #1976d2; } .bg-gray { background: #607d8b; }

        #res-display { margin-top: 15px; padding: 15px; border-radius: 10px; text-align: center; display: none; font-size: 18px; border: 2px solid #ccc; }
        .is-win { background: #e8f5e9; border-color: #4caf50; color: #1b5e20; }
        #loading { text-align: center; padding: 20px; color: #666; font-style: italic; }
    </style>
</head>
<body>

<header>Winnerå°åŠ©æ‰‹ v6.0 - ä¹å¤§å½©åˆ¸æ•´åˆç‰ˆ</header>

<div class="nav-tabs" id="tabs">
    <button class="tab-btn active" onclick="switchGame('è³“æœè³“æœ')">è³“æœè³“æœ</button>
    <button class="tab-btn" onclick="switchGame('å¤§æ¨‚é€')">å¤§æ¨‚é€</button>
    <button class="tab-btn" onclick="switchGame('å¨åŠ›å½©')">å¨åŠ›å½©</button>
    <button class="tab-btn" onclick="switchGame('ä»Šå½©539')">ä»Šå½©539</button>
    <button class="tab-btn" onclick="switchGame('3æ˜Ÿå½©')">3æ˜Ÿå½©</button>
    <button class="tab-btn" onclick="switchGame('4æ˜Ÿå½©')">4æ˜Ÿå½©</button>
    <button class="tab-btn" onclick="switchGame('39æ¨‚åˆå½©')">39æ¨‚åˆå½©</button>
    <button class="tab-btn" onclick="switchGame('49æ¨‚åˆå½©')">49æ¨‚åˆå½©</button>
    <button class="tab-btn" onclick="switchGame('å¤§æ¨‚é€åŠ é–‹')">å¤§æ¨‚é€åŠ é–‹</button>
</div>

<div class="container">
    <div class="card">
        <h3 id="game-title" style="margin-top:0">è³“æœè³“æœå°ç</h3>
        
        <div id="bingo-tools" class="bingo-panel">
            <div class="option-group">
                <label>ç©æ³•é¡å‹</label>
                <select id="bingo-mode">
                    <option value="star">çŒœæ•¸å­— (1-10æ˜Ÿ)</option>
                    <option value="bs">çŒœå¤§å°</option>
                    <option value="oe">çŒœå–®é›™</option>
                </select>
            </div>
            <div class="option-group">
                <label>æŠ•æ³¨å€æ•¸</label>
                <select id="bingo-mult"><option value="1">1å€</option><option value="5">5å€</option><option value="10">10å€</option></select>
            </div>
            <div class="option-group">
                <label>ç›®æ¨™æœŸæ•¸</label>
                <select id="sel-period"></select>
            </div>
        </div>

        <div class="check-area">
            <input type="text" id="user-input" class="main-input" placeholder="è¼¸å…¥è™Ÿç¢¼ (ç”¨ç©ºæ ¼éš”é–‹)">
            <button class="btn-check" onclick="startCheck()">ç«‹åˆ»å°çè¨ˆç®—</button>
        </div>
        
        <div id="res-display"></div>
    </div>

    <div class="card">
        <h4 style="margin-top:0">æœ€æ–°é–‹çæ­·å²</h4>
        <div id="loading">è¼‰å…¥è³‡æ–™ä¸­...</div>
        <div id="history-list"></div>
    </div>
</div>

<script>
// --- 9 ç¨®å½©åˆ¸å®Œæ•´é…ç½® ---
const CONFIG = {
    'è³“æœè³“æœ': { file: 'è³“æœè³“æœ_2026.csv', balls: 'é–‹å‡ºè™Ÿç¢¼', super: 'è¶…ç´šçè™Ÿ' },
    'å¤§æ¨‚é€': { file: 'å¤§æ¨‚é€_2026.csv', balls: ['çè™Ÿ1','çè™Ÿ2','çè™Ÿ3','çè™Ÿ4','çè™Ÿ5','çè™Ÿ6'], super: 'ç‰¹åˆ¥è™Ÿ' },
    'å¨åŠ›å½©': { file: 'å¨åŠ›å½©_2026.csv', balls: ['ç¬¬ä¸€å€1','ç¬¬ä¸€å€2','ç¬¬ä¸€å€3','ç¬¬ä¸€å€4','ç¬¬ä¸€å€5','ç¬¬ä¸€å€6'], super: 'ç¬¬äºŒå€' },
    'ä»Šå½©539': { file: 'ä»Šå½©539_2026.csv', balls: ['çè™Ÿ1','çè™Ÿ2','çè™Ÿ3','çè™Ÿ4','çè™Ÿ5'], super: null },
    '3æ˜Ÿå½©': { file: '3æ˜Ÿå½©_2026.csv', balls: ['çè™Ÿ1','çè™Ÿ2','çè™Ÿ3'], super: null },
    '4æ˜Ÿå½©': { file: '4æ˜Ÿå½©_2026.csv', balls: ['çè™Ÿ1','çè™Ÿ2','çè™Ÿ3','çè™Ÿ4'], super: null },
    '39æ¨‚åˆå½©': { file: '39æ¨‚åˆå½©_2026.csv', balls: ['çè™Ÿ1','çè™Ÿ2','çè™Ÿ3','çè™Ÿ4','çè™Ÿ5'], super: null },
    '49æ¨‚åˆå½©': { file: '49æ¨‚åˆå½©_2026.csv', balls: ['çè™Ÿ1','çè™Ÿ2','çè™Ÿ3','çè™Ÿ4','çè™Ÿ5','çè™Ÿ6'], super: null },
    'å¤§æ¨‚é€åŠ é–‹': { file: 'å¤§æ¨‚é€åŠ é–‹çé …_2026.csv', balls: ['çè™Ÿ1','çè™Ÿ2','çè™Ÿ3','çè™Ÿ4','çè™Ÿ5','çè™Ÿ6'], super: null }
};

let gameName = 'è³“æœè³“æœ';
let gameData = [];

// è³“æœç°¡æ˜“çé‡‘è¡¨ (1-2æ˜Ÿç¯„ä¾‹)
const BINGO_PRIZE = { "star1": { 1: 50 }, "star2": { 2: 75, 1: 25 } };

window.onload = () => switchGame('è³“æœè³“æœ');

async function switchGame(name) {
    gameName = name;
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.toggle('active', b.innerText === name));
    document.getElementById('game-title').innerText = name + 'å°ç';
    document.getElementById('bingo-tools').style.display = (name === 'è³“æœè³“æœ') ? 'grid' : 'none';
    await loadData();
}

async function loadData() {
    const list = document.getElementById('history-list');
    const loading = document.getElementById('loading');
    list.innerHTML = ''; loading.style.display = 'block';

    try {
        // ğŸ’¡ é—œéµï¼šå°ä¸­æ–‡æª”åé€²è¡Œç·¨ç¢¼è™•ç†
        const fileName = encodeURIComponent(CONFIG[gameName].file);
        const res = await fetch(`./lotto/${fileName}`);
        if (!res.ok) throw new Error('è®€å–å¤±æ•—');
        const text = await res.text();
        gameData = parseCSV(text);
        
        // å¡«å……æœŸæ•¸é¸å–®
        const pSel = document.getElementById('sel-period');
        pSel.innerHTML = gameData.slice(0, 30).map(d => {
            const val = d.æœŸæ•¸ || d.æœŸåˆ¥;
            return `<option value="${val}">${val}</option>`;
        }).join('');
        
        renderHistory();
    } catch (e) { list.innerHTML = 'è®€å–å¤±æ•—ï¼Œè«‹ç¢ºèªæª”æ¡ˆå·²æ­£ç¢ºä¸Šå‚³è‡³ lotto è³‡æ–™å¤¾ã€‚'; }
    finally { loading.style.display = 'none'; }
}

function parseCSV(text) {
    const lines = text.trim().split('\n');
    const headers = lines[0].split(',').map(h => h.trim());
    return lines.slice(1).map(l => {
        let vals = [], inQ = false, cell = '';
        for (let char of l) {
            if (char === '"') inQ = !inQ;
            else if (char === ',' && !inQ) { vals.push(cell.trim()); cell = ''; }
            else cell += char;
        }
        vals.push(cell.trim());
        let o = {}; headers.forEach((h, i) => o[h] = vals[i]);
        return o;
    });
}

function renderHistory() {
    const container = document.getElementById('history-list');
    gameData.slice(0, 5).forEach(row => {
        const item = document.createElement('div');
        item.style.padding = '12px 0'; item.style.borderBottom = '1px solid #eee';
        
        let balls = [];
        if (gameName === 'è³“æœè³“æœ') {
            balls = row['é–‹å‡ºè™Ÿç¢¼'].split(/[ ,]+/).filter(n => n.length > 0);
        } else {
            CONFIG[gameName].balls.forEach(k => balls.push(row[k]));
        }

        let ballHtml = balls.map(n => `<div class="ball">${n.padStart(2,'0')}</div>`).join('');
        if (CONFIG[gameName].super && row[CONFIG[gameName].super]) {
            ballHtml += `<div class="ball sp">${row[CONFIG[gameName].super].padStart(2,'0')}</div>`;
        }

        let tags = '';
        if (gameName === 'è³“æœè³“æœ') {
            tags = `<span class="badge bg-blue">å¤§å°: ${row['å¤§å°']||'ï¼'}</span><span class="badge bg-gray">å–®é›™: ${row['å–®é›™']||'ï¼'}</span>`;
        }

        item.innerHTML = `<strong>ç¬¬ ${row.æœŸæ•¸ || row.æœŸåˆ¥} æœŸ</strong> <small>${row.æ—¥æœŸ || row.é–‹çæ—¥æœŸ}</small> ${tags}<div class="ball-grid">${ballHtml}</div>`;
        container.appendChild(item);
    });
}

function startCheck() {
    const p = document.getElementById('sel-period').value;
    const draw = gameData.find(d => (d.æœŸæ•¸ || d.æœŸåˆ¥) === p);
    const box = document.getElementById('res-display');
    const input = document.getElementById('user-input').value.trim();
    if (!draw || !input) return;

    let winBalls = [];
    if (gameName === 'è³“æœè³“æœ') {
        winBalls = draw['é–‹å‡ºè™Ÿç¢¼'].split(/[ ,]+/).map(n => n.trim().padStart(2,'0'));
        winBalls.push(draw['è¶…ç´šçè™Ÿ'].padStart(2,'0'));
    } else {
        CONFIG[gameName].balls.forEach(k => winBalls.push(draw[k].padStart(2,'0')));
    }

    const userBalls = input.split(/[ ,]+/).map(n => n.padStart(2,'0'));
    const matched = userBalls.filter(n => winBalls.includes(n));
    
    box.style.display = 'block';
    box.className = matched.length > 0 ? 'is-win' : '';
    
    if (gameName === 'è³“æœè³“æœ') {
        const mode = document.getElementById('bingo-mode').value;
        if (mode === 'bs') {
            const ok = input.includes(draw['å¤§å°']);
            box.innerHTML = `é–‹ççµæœï¼š<b>${draw['å¤§å°']}</b><br>${ok ? 'ğŸŠ çŒœä¸­äº†ï¼' : 'âŒ æ²’çŒœä¸­'}`;
        } else if (mode === 'oe') {
            const ok = input.includes(draw['å–®é›™']);
            box.innerHTML = `é–‹ççµæœï¼š<b>${draw['å–®é›™']}</b><br>${ok ? 'ğŸŠ çŒœä¸­äº†ï¼' : 'âŒ æ²’çŒœä¸­'}`;
        } else {
            box.innerHTML = `å°ä¸­ <b>${matched.length}</b> é¡†è™Ÿç¢¼ï¼<br>çé‡‘è«‹å°ç…§å°å½©å®˜ç¶²ã€‚`;
        }
    } else {
        box.innerHTML = `ç¬¬ ${p} æœŸ å°ä¸­ <b>${matched.length}</b> é¡†è™Ÿç¢¼ï¼`;
    }
}
</script>
</body>
</html>
