<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Winnerå°åŠ©æ‰‹ - å…¨èƒ½å°çç³»çµ±</title>
    <style>
        /* --- æ ¸å¿ƒè¦–è¦ºè¨­è¨ˆ --- */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f6; margin: 0; padding: 0; color: #333; }
        header { background: linear-gradient(135deg, #d32f2f, #f44336); color: white; padding: 15px 20px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h1 { margin: 0; font-size: 24px; }
        
        /* é¸å–®å°è¦½åˆ— */
        .nav-tabs { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; padding: 15px; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .tab-btn { padding: 10px 18px; border: none; background: #e0e0e0; border-radius: 25px; cursor: pointer; font-size: 15px; font-weight: bold; transition: 0.3s; }
        .tab-btn:hover { background: #ffc107; }
        .tab-btn.active { background: #ff9800; color: white; box-shadow: 0 2px 5px rgba(255,152,0,0.4); }

        /* ä¸»å…§å®¹å€å¡Š */
        .container { max-width: 800px; margin: 20px auto; padding: 0 15px; }
        .card { background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        
        /* å¿«é€Ÿå°çè¼¸å…¥å€ */
        .check-area { display: flex; gap: 10px; align-items: center; justify-content: center; flex-wrap: wrap; }
        .check-input { padding: 12px; font-size: 18px; border: 2px solid #ddd; border-radius: 8px; width: 100%; max-width: 350px; text-align: center; }
        .check-btn { padding: 12px 25px; font-size: 18px; background: #4caf50; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .check-btn:hover { background: #45a049; }

        /* å½©çƒè¦–è¦ºè¨­è¨ˆ */
        .ball-row { display: flex; gap: 6px; flex-wrap: wrap; align-items: center; margin-top: 10px; }
        .ball { width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 16px; color: #333; background: radial-gradient(circle at 12px 12px, #fffde7, #ffd54f); box-shadow: 1px 2px 4px rgba(0,0,0,0.2); }
        .ball.special { background: radial-gradient(circle at 12px 12px, #ffebee, #ef5350); color: white; }
        
        /* è³“æœå°ˆç”¨æ¨™ç±¤ (å¤§å°/å–®é›™) */
        .badge { display: inline-block; padding: 4px 10px; border-radius: 12px; background: #2196f3; color: white; font-size: 13px; font-weight: bold; margin-left: 5px; }
        .badge.dark { background: #607d8b; }

        /* é–‹çæ­·å²åˆ—è¡¨ */
        .history-item { border-bottom: 1px solid #eee; padding: 15px 0; }
        .history-item:last-child { border-bottom: none; }
        .draw-info { font-size: 15px; color: #555; margin-bottom: 8px; font-weight: bold; }
        
        #loading { text-align: center; color: #666; font-style: italic; display: none; margin: 20px 0; }
    </style>
</head>
<body>

    <header>
        <h1>ğŸ† Winnerå°åŠ©æ‰‹ - å…¨èƒ½å°çä¸­å¿ƒ</h1>
    </header>

    <div class="nav-tabs" id="tabs">
        <button class="tab-btn active" onclick="switchLotto('è³“æœè³“æœ')">è³“æœè³“æœ</button>
        <button class="tab-btn" onclick="switchLotto('å¤§æ¨‚é€')">å¤§æ¨‚é€</button>
        <button class="tab-btn" onclick="switchLotto('å¨åŠ›å½©')">å¨åŠ›å½©</button>
        <button class="tab-btn" onclick="switchLotto('ä»Šå½©539')">ä»Šå½©539</button>
        <button class="tab-btn" onclick="switchLotto('3æ˜Ÿå½©')">3æ˜Ÿå½©</button>
        <button class="tab-btn" onclick="switchLotto('4æ˜Ÿå½©')">4æ˜Ÿå½©</button>
    </div>

    <div class="container">
        <div class="card">
            <h2 style="margin-top:0; text-align:center;" id="checker-title">å¿«é€Ÿå°ç - è³“æœè³“æœ</h2>
            <p style="text-align:center; color:#666; font-size:14px;">è«‹è¼¸å…¥ä½ çš„è™Ÿç¢¼ï¼ˆç”¨ç©ºæ ¼éš”é–‹ï¼‰ï¼Œç³»çµ±æœƒè‡ªå‹•æ¯”å°æœ€æ–°ä¸€æœŸï¼</p>
            <div class="check-area">
                <input type="text" id="userNumbers" class="check-input" placeholder="ä¾‹å¦‚: 05 12 23 34 45 49">
                <button class="check-btn" onclick="checkNumbers()">ç«‹åˆ»å°ç</button>
            </div>
            <div id="check-result" style="margin-top: 15px; text-align: center; font-weight: bold; font-size: 18px;"></div>
        </div>

        <div class="card">
            <h2 style="margin-top:0;">æœ€æ–°é–‹çç´€éŒ„</h2>
            <div id="loading">è³‡æ–™è¼‰å…¥ä¸­ï¼Œè«‹ç¨å€™...</div>
            <div id="history-container"></div>
        </div>
    </div>

    <script>
        // --- è¨­å®šæª”ï¼šæ”¯æ´æ‰€æœ‰å½©åˆ¸ï¼ŒåŒ…å«è³“æœçš„ç‰¹æ®Šæ ¼å¼ ---
        const config = {
            'è³“æœè³“æœ': {
                file: 'è³“æœè³“æœ_2026.csv', // ğŸ’¡ è«‹ç¢ºä¿ä½ ä¸Šå‚³çš„æª”æ¡ˆæª”åå«é€™å€‹
                normalCols: ['é–‹å‡ºè™Ÿç¢¼'],    // è£¡é¢æ˜¯é€—è™Ÿåˆ†éš”çš„ 19 é¡†çƒ
                specialCol: 'è¶…ç´šçè™Ÿ',
                extraTags: ['å¤§å°', 'å–®é›™'] // é¡¯ç¤ºå¤§å°å–®é›™çš„å°ˆå±¬æ¬„ä½
            },
            'å¤§æ¨‚é€': {
                file: 'å¤§æ¨‚é€_2026.csv',
                normalCols: ['çè™Ÿ1', 'çè™Ÿ2', 'çè™Ÿ3', 'çè™Ÿ4', 'çè™Ÿ5', 'çè™Ÿ6'],
                specialCol: 'ç‰¹åˆ¥è™Ÿ',
                extraTags: []
            },
            'å¨åŠ›å½©': {
                file: 'å¨åŠ›å½©_2026.csv',
                normalCols: ['ç¬¬ä¸€å€1', 'ç¬¬ä¸€å€2', 'ç¬¬ä¸€å€3', 'ç¬¬ä¸€å€4', 'ç¬¬ä¸€å€5', 'ç¬¬ä¸€å€6'],
                specialCol: 'ç¬¬äºŒå€',
                extraTags: []
            },
            'ä»Šå½©539': {
                file: 'ä»Šå½©539_2026.csv',
                normalCols: ['çè™Ÿ1', 'çè™Ÿ2', 'çè™Ÿ3', 'çè™Ÿ4', 'çè™Ÿ5'],
                specialCol: null,
                extraTags: []
            },
            '3æ˜Ÿå½©': {
                file: '3æ˜Ÿå½©_2026.csv',
                normalCols: ['çè™Ÿ1', 'çè™Ÿ2', 'çè™Ÿ3'],
                specialCol: null,
                extraTags: []
            },
            '4æ˜Ÿå½©': {
                file: '4æ˜Ÿå½©_2026.csv',
                normalCols: ['çè™Ÿ1', 'çè™Ÿ2', 'çè™Ÿ3', 'çè™Ÿ4'],
                specialCol: null,
                extraTags: []
            }
        };

        let currentLotto = 'è³“æœè³“æœ'; // é è¨­é¡¯ç¤ºè³“æœè³“æœ
        let currentData = [];

        window.onload = () => {
            loadLottoData(currentLotto);
        };

        function switchLotto(lottoName) {
            currentLotto = lottoName;
            document.getElementById('checker-title').innerText = `å¿«é€Ÿå°ç - ${lottoName}`;
            document.getElementById('check-result').innerHTML = ''; 
            
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            loadLottoData(lottoName);
        }

        async function loadLottoData(lottoName) {
            const uiContainer = document.getElementById('history-container');
            const loading = document.getElementById('loading');
            const setting = config[lottoName];

            uiContainer.innerHTML = '';
            loading.style.display = 'block';

            try {
                // ğŸ’¡ å» lotto è³‡æ–™å¤¾æŠ“è³‡æ–™
                const response = await fetch(`./lotto/${setting.file}`);
                if (!response.ok) throw new Error('æª”æ¡ˆè®€å–å¤±æ•—');
                const csvText = await response.text();
                
                currentData = parseCSV(csvText);
                renderHistory(currentData, setting);
            } catch (error) {
                console.error(error);
                uiContainer.innerHTML = `<p style="color:red; font-weight:bold;">ç„¡æ³•è¼‰å…¥ ${setting.file}ï¼<br>è«‹ç¢ºèªæª”æ¡ˆå·²ä¸Šå‚³è‡³ GitHub çš„ lotto è³‡æ–™å¤¾ï¼Œä¸¦ä¸”æª”åå®Œå…¨ä¸€è‡´ã€‚</p>`;
            } finally {
                loading.style.display = 'none';
            }
        }

        // CSV æ™ºæ…§è§£æå™¨
        function parseCSV(text) {
            const results = [];
            const rows = text.trim().split(/\r?\n/);
            const headers = rows[0].split(','); 
            for (let i = 1; i < rows.length; i++) {
                if (rows[i].trim() === '') continue;
                
                // è™•ç†å¼•è™ŸåŒ…è¦†çš„é€—è™Ÿ (æœ‰äº› CSV è¼¸å‡ºæ™‚æœƒé€™æ¨£åŒ…è£)
                let cols = [];
                let inQuotes = false;
                let currentVal = '';
                for(let char of rows[i]) {
                    if(char === '"') inQuotes = !inQuotes;
                    else if(char === ',' && !inQuotes) { cols.push(currentVal); currentVal = ''; }
                    else currentVal += char;
                }
                cols.push(currentVal);

                let rowObj = {};
                headers.forEach((header, index) => {
                    rowObj[header.trim()] = cols[index] ? cols[index].trim() : '';
                });
                results.push(rowObj);
            }
            return results;
        }

        function renderHistory(data, setting) {
            const container = document.getElementById('history-container');
            const displayData = data.slice(0, 10); // é¡¯ç¤ºæœ€æ–° 10 æœŸ

            displayData.forEach(row => {
                const item = document.createElement('div');
                item.className = 'history-item';
                
                // æœŸæ•¸ã€æ—¥æœŸèˆ‡æ™‚é–“
                const info = document.createElement('div');
                info.className = 'draw-info';
                
                // æª¢æŸ¥æ˜¯å¦æœ‰é–‹çæ™‚é–“ (è³“æœå°ˆå±¬)
                let timeStr = row['é–‹çæ™‚é–“'] ? ` ${row['é–‹çæ™‚é–“']}` : '';
                // æª¢æŸ¥æ˜¯å¦æœ‰æœŸåˆ¥æˆ–æœŸæ•¸çš„æ¨™é¡Œå·®ç•°
                let periodVal = row['æœŸåˆ¥'] || row['æœŸæ•¸'] || 'æœªçŸ¥';
                let dateVal = row['é–‹çæ—¥æœŸ'] || row['æ—¥æœŸ'] || 'æœªçŸ¥';
                
                info.innerText = `ç¬¬ ${periodVal} æœŸ | ${dateVal}${timeStr}`;
                
                // åŠ å…¥å¤§å°å–®é›™çš„å¾½ç« æ¨™ç±¤
                setting.extraTags.forEach(tag => {
                    if(row[tag] && row[tag] !== 'ï¼') {
                        const badge = document.createElement('span');
                        badge.className = tag === 'å¤§å°' ? 'badge' : 'badge dark';
                        badge.innerText = `${tag}: ${row[tag]}`;
                        info.appendChild(badge);
                    }
                });

                item.appendChild(info);

                // å»ºç«‹å½©çƒ
                const ballRow = document.createElement('div');
                ballRow.className = 'ball-row';

                // ä¸€èˆ¬è™Ÿç¢¼ (æ”¯æ´é™£åˆ—æ‹†è§£)
                setting.normalCols.forEach(col => {
                    if(row[col]) {
                        // ğŸ’¡ æ™ºæ…§åˆ¤æ–·ï¼šå¦‚æœè£¡é¢æœ‰é€—è™Ÿï¼Œå°±åˆ‡é–‹è®Šæˆå¤šé¡†çƒ (å°ˆç‚ºè³“æœè¨­è¨ˆ)
                        const nums = row[col].includes(',') ? row[col].split(',') : [row[col]];
                        nums.forEach(n => {
                            if(n.trim() === '') return;
                            const ball = document.createElement('div');
                            ball.className = 'ball';
                            ball.innerText = n.trim().padStart(2, '0');
                            ballRow.appendChild(ball);
                        });
                    }
                });

                // ç‰¹åˆ¥è™Ÿ/è¶…ç´šçè™Ÿ
                if (setting.specialCol && row[setting.specialCol]) {
                    const spBall = document.createElement('div');
                    spBall.className = 'ball special';
                    spBall.innerText = row[setting.specialCol].trim().padStart(2, '0');
                    ballRow.appendChild(spBall);
                }

                item.appendChild(ballRow);
                container.appendChild(item);
            });
        }

        function checkNumbers() {
            if (currentData.length === 0) return;
            
            const input = document.getElementById('userNumbers').value;
            const userNums = input.replace(/,/g, ' ').split(/\s+/).filter(n => n !== '').map(n => n.padStart(2, '0'));
            
            if (userNums.length === 0) {
                alert('è«‹è¼¸å…¥è™Ÿç¢¼ï¼');
                return;
            }

            const latestDraw = currentData[0]; 
            const setting = config[currentLotto];
            let periodVal = latestDraw['æœŸåˆ¥'] || latestDraw['æœŸæ•¸'];
            
            let matchedNormal = 0;
            let matchedSpecial = false;

            // æ¯”å°ä¸€èˆ¬è™Ÿç¢¼ (æ”¯æ´é™£åˆ—æ‹†è§£)
            setting.normalCols.forEach(col => {
                if(latestDraw[col]) {
                    const nums = latestDraw[col].includes(',') ? latestDraw[col].split(',') : [latestDraw[col]];
                    nums.forEach(n => {
                        const winningNum = n.trim().padStart(2, '0');
                        if (userNums.includes(winningNum)) matchedNormal++;
                    });
                }
            });

            // æ¯”å°ç‰¹åˆ¥è™Ÿ
            if (setting.specialCol && latestDraw[setting.specialCol]) {
                const specialNum = latestDraw[setting.specialCol].trim().padStart(2, '0');
                if (userNums.includes(specialNum)) matchedSpecial = true;
            }

            // é¡¯ç¤ºçµæœ
            const resultBox = document.getElementById('check-result');
            let resultText = `ğŸ¯ å°ççµæœ (æœ€æ–°ç¬¬ ${periodVal} æœŸ)ï¼š<br>`;
            resultText += `å°ä¸­ <span style="color:#d32f2f; font-size:24px;">${matchedNormal}</span> å€‹ä¸€èˆ¬è™Ÿç¢¼`;
            
            if (setting.specialCol) {
                resultText += matchedSpecial ? 'ï¼Œ<span style="color:#4caf50;">è¶…ç´šçè™Ÿå‘½ä¸­ï¼</span>' : 'ï¼Œè¶…ç´šçè™Ÿæ²’ä¸­ã€‚';
            }
            
            resultBox.innerHTML = resultText;
        }
    </script>
</body>
</html>

